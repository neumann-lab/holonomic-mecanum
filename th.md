## Holonomic Mecanum Drive for NovaPi
> Gemini, Piyaphat Liamwilai, Updated: 9/9/24
## จุดเริ่มต้น
ในการแข่งขัน MakeX Challenger, การเคลื่อนที่ถือว่าเป็นปัจจัยหลักทำให้การเคลื่อนที่แบบ Holonomic หรือความสามารถที่จะขับเคลื่อนหุ่นได้รอบทิศทางโดยไม่ต้องหันหุ่นถือว่าเป็นอะไรที่สำคัญมากๆ พวกเราจึงศึกษาล้อ Mecanum เพื่อที่จะทำการเคลื่อนที่แบบ Holonomic โดยใช้ล้อ Mecanum ให้เป็นไปได้
## อะไรคือล้อ Mecanum?
ล้อ Mecanum คือล้อที่มีลูกกลิ้งติดอยู่ที่ 45 องศา ลูกกลื้งที่ติดไว้ 45 องศานั้นช่วยเพิ่มความสามารถในการเดินแบบรอบทิศทางทำให้สามารถหุ่นนั้นเดินได้ตามทิศทางที่ต้องการหากพลังของล้อที่ใช้นั้นถูกต้อง วิธีการติดที่ได้ประสิทธิภาพมากที่สุดนั้นจะเป็นไปตามรูปภาพนี้
![Mecanum-robot-chassis-met-demping-4](https://github.com/user-attachments/assets/1b54ab9d-01a5-4f5c-8efc-eb2a8c5e7da5)

(ขอขอบคุณรูปภาพจาก elektronicavoorjou.nl)
## ศึกษาการเดินของหุ่นที่ใช้ Mecanum
ก่อนที่เราจะคำนวณพลังของล้อ Mecanum เราต้องรู้วิธีการเดินของหุ่นที่ใช้ล้อ Mecanum ก่อนซึ่งเป็นไปตามตารางนี้
(+ คือมอเตอร์หมุนไปด้านหน้า, 0 คือมอเตอร์หยุด, - คือมอเตอร์หมุนกลับด้าน)
| ประเภทการเดิน | ล้อหน้าซ้าย  | ล้อหน้าขวา | ล้อหลังซ้าย | ล้อหลังขวา |
| ------------- | ------------- | ------------- | ------------- | ------------- |
| เดินตรง | + | + | + | + |
| เดินถอยหลัง | - | - | - | - |
| สไลด์ขวา | + | - | - | + |
| สไลด์ซ้าย | - | + | + | - |
| สไลด์เฉียงขวา | + | 0 | 0 | + |
| สไลด์เฉียงซ้าย | 0 | + | + | 0 |
| หมุนขวา | + | - | + | - |
| หมุนซ้าย | - | + | - | + |
## การหาสูตรเพื่อใช้คำนวณล้อ
เราสามารถดูจากตารางการเดินของหุ่นที่ใช้ Mecanum และหาความสัมพันธ์ระหว่างทิศทางที่ล้อหมุนกับการเคลื่อนที่ของหุ่น ตัวอย่างได้แก่ ล้อหน้าซ้าย จากการดูจากตาราง เราสามารถเห็นได้ว่าถ้าหุ่นจะเดินหน้า ล้อหน้าซ้ายต้องหมุนไปข้างหน้า แสดงว่าล้อนี้ต้องมีค่า $$V_{y}$$ เป็นบวก และหุ่นจะสไลด์ไปทางขวาได้ก็ต่อเมื่อล้อหน้าซ้ายหมุนไปข้างหน้า แสดงว่าล้อนี้มีค่า $$V_{x}$$ เป็นบวก และ หุ่นจะหมุนไปทางขวาเมื่อล้อนี้หมุนไปข้างหน้า แสดงว่าล้อนี้มีค่า $$\omega_{L}$$ เป็นบวก
## คำนวณพลังของแต่ละล้อ
เมื่อ $$V_{x}$$ คือความเร็วในแกน X, $$V_{y}$$ คือความเร็วในแกน Y, $$\omega_{L}$$ คือความเร็วที่ต้องการจะหมุน

สำหรับล้อหน้าซ้าย

$$V_{FL} = V_{x}  + V_{y} + \omega_{L}$$

สำหรับล้อหน้าขวา

$$V_{FR} = -V_{x}  + V_{y} - \omega_{L}$$

สำหรับล้อหลังซ้าย

$$V_{BL} = -V_{x}  + V_{y} + \omega_{L}$$

สำหรับล้อหลังขวา

$$V_{BR} = V_{x}  + V_{y} - \omega_{L}$$
## การนำ PID มาเข้าร่วม
เราสามารถใช้ค่าที่ล้อกำลังหมุนอยู่มาลบกับค่าที่ต้องการจะหมุนหรือความเร็วที่คำนวณได้เพื่อใช้ค่าเป็น Error สำหรับ PID Controller ซึ่งจะสามารถทำให้เรานั้นเดินได้เสถียรขึ้น
## การนำเป็นใช้ในโค้ด
[ตัวอย่างสามารถพบได้ที่นี้](holonomic.py)
